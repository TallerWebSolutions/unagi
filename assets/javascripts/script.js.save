/**
 * @file
 * JS for Radix Starter.
 */
(function ($) {

  Drupal.behaviors.unary_bootstrap_select = {
    attach: function(context) {
      $( document ).ready(function() {
      	$("select[multiple='multiple']").selectpicker();
      }); //endoff document ready
    }
  };

  Drupal.behaviors.unary_scrollfollow = {
    attach: function () {
      var settings = {
      	// element: jQuery('.burr-flipped-sidebar-inner')
        element: jQuery('.pane-node-form-buttons')
      };

      if (settings.element.length) {
        this.scrollFollowSidebar(settings);
      }
    },

    scrollFollowSidebar: function (settings) {
      /**
       * Namespace and class settings.
       */
      var _this = {};
      _this.settings = settings;


			/**
			 * Constructor is like a summary of process.
			 */
      function init () {
        setup();
        events();
      };


			/**
			 * Starts initial and global objects.
			 */
      function setup () {
        _this.sidebar = _this.settings.element;
        _this.pageWrap = jQuery('#main-wrapper');
        _this.window = jQuery(window);
        _this.offset = _this.sidebar.offset();
        _this.safeareaH = getSafeareaHeight();
        _this.maxPosition = getMaxBottomPosition();
      };


      /**
       * General events.
       */
      function events () {
        _this.window.scroll(function (ev) {
        	scrollFollow();
        });
      };


      /**
       * The math and animation for sidebar position.
       * + 100 = magic margin :)
       */
      function scrollFollow () {
      	if (_this.window.scrollTop() > _this.offset.top) {
      		if (_this.window.scrollTop() < _this.maxPosition) {
	      		_this.sidebar.stop().animate({
	      			marginTop: _this.window.scrollTop() - _this.offset.top + _this.safeareaH + 100
      			});
      		}
      	}
      	else {
      		_this.sidebar.stop().animate({
      			marginTop: 0
      		});
      	}
      };


      /**
       * Get the height of admin topbar.
       * @return {int} Topbar height in pixels.
       */
			function getSafeareaHeight () {
				var navbar = jQuery('#navbar-bar'),
						navtray = jQuery('#navbar-tray');

				return parseInt(navbar.outerHeight() + navtray.outerHeight());
			};


			/**
			 * Calculates the max margin top position for sidebar.
			 * @return {int} Height position in pixels.
			 */
			function getMaxBottomPosition () {
				var wrapH = _this.pageWrap.outerHeight();
				return parseInt(wrapH - _this.sidebar.outerHeight());
			};


			/**
			 * Let's Go!
			 */
      init();
    }
  };

  Drupal.behaviors.unary_scrollfollow = {
    attach: function () {
      $stickyElem = $('')
      $(window).scroll(function() {
        console.log()
      });
    }
  }

})(jQuery);
